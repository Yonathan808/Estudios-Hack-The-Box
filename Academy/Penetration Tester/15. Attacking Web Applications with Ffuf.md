# Web Fuzzing

Permite automatizar el fuzzing web.
Parámetros clave:

```bash
-w <wordlist:KEY>      # wordlist y palabra clave (ej. :FUZZ)
-u <url>               # target URL (usar FUZZ donde corresponda)
-H 'Header: VALUE'     # header (ej. -H 'Host: FUZZ.domain')
-X POST                # forzar método POST
-d 'data'              # datos POST (ej. 'FUZZ=key' o 'id=FUZZ')
-e .php                # extensión forzada en recursión
-recursion             # habilita recursión
-recursion-depth <n>   # profundidad de recursión
-fs <size>             # filter response size (filtrar respuestas con ese tamaño)
-mc / -ms / -mw        # matchers (status, size, words)
-t <threads>           # threads (p.ej. -t 200)
-v                     # verbose (muestra URL completas)
```

```bash
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
```
## Tipos de Fuzzing

### Directory Fuzzing (fuzz de directorios)
```bash
# Ejemplo básico (asignando la palabra clave FUZZ al wordlist)
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ

# Variante (misma idea, repetida en el texto)
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ

# Aumentar threads (no recomendado en objetivo remoto)
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -t 200
```

### Extension Fuzzing (buscar la extensión del index)
```bash
# Fuzz de extensiones para index (web-extensions.txt contiene el punto .)
ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```

### Page Fuzzing (fuzz de nombres de archivos con .php)
```bash
# Fuzz dentro de /blog para archivos .php
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php
```
 
### Escaneo recursivo (automático en subdirectorios)
```bash
# Recursión, profundidad 1, forzar extensión .php, verbose para ver URLs completas
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ \
     -u http://SERVER_IP:PORT/FUZZ \
     -recursion -recursion-depth 1 -e .php -v
```

### DNS / hosts (redirigir nombre a IP local)
```bash
# Añadir academy.htb al /etc/hosts apuntando a SERVER_IP
sudo sh -c 'echo "SERVER_IP  academy.htb" >> /etc/hosts'
```

### Sub-domain Fuzzing (DNS público)
```bash
# Fuzz de subdominios públicos para inlanefreight.com
ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
     -u https://FUZZ.inlanefreight.com/

# Intento contra academy.htb (no público -> no devolverá hits a menos que estén en /etc/hosts)
ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
     -u http://FUZZ.academy.htb/
```

### VHost Fuzzing (Host header)
```bash
# Fuzz enviando distintos Host: headers (VHosts) a la IP / dominio local
ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
     -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'
```

### Parameter Fuzzing — GET
```bash
# Fuzz de nombres de parámetros (GET) en admin.php (usa burp-parameter-names.txt)
ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
     -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx
```

### Parameter Fuzzing — POST
```bash
# Fuzz de nombres de parámetros (POST). Importante: especificar método POST y Content-Type
ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
     -u http://admin.academy.htb:PORT/admin/admin.php \
     -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx
```

### Probar manualmente con curl (ejemplo POST)
```bash
curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'
```

### Value Fuzzing (fuzz de valores para parámetros)
```bash
# Crear lista de ids 1..1000
for i in $(seq 1 1000); do echo $i >> ids.txt; done

# Ver contenido
cat ids.txt

# Fuzzando el valor del parámetro id con la lista creada
ffuf -w ids.txt:FUZZ \
     -u http://admin.academy.htb:PORT/admin/admin.php \
     -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx
```

